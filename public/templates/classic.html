<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{productName}} â€” Product Preview</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Poppins', sans-serif; }
    body { background: #f5f7fb; color: #222; line-height: 1.6; }
    .wrapper { max-width: 960px; margin: 40px auto; background: #fff; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); overflow: hidden; }

    header {
      background: linear-gradient(135deg, #5b4bff, #8a6dff);
      color: white; padding: 40px;
      text-align: center;
    }
    header h1 { font-size: 2.2em; letter-spacing: 1px; }
    header p { opacity: 0.9; margin-top: 8px; }

    .product-visual {
      width: 100%;
      max-height: 400px;
      overflow: hidden;
      text-align: center;
      background: #f2f2f2;
    }
    .product-visual img {
      width: 100%;
      height: auto;
      object-fit: cover;
      display: block;
    }
    .product-visual iframe {
      width: 100%;
      height: 400px;
      border: none;
      display: block;
    }

    section { padding: 40px; border-bottom: 1px solid #eee; }
    h2 { font-size: 1.4em; color: #444; margin-bottom: 20px; border-left: 4px solid #5b4bff; padding-left: 10px; }

    .product-desc { font-size: 1.05em; margin-bottom: 15px; color: #333; }
    .price { font-weight: 600; color: #5b4bff; font-size: 1.2em; margin: 10px 0; }
    .cta { display: inline-block; padding: 12px 28px; background: #5b4bff; color: white; text-decoration: none; border-radius: 8px; margin-top: 10px; font-weight: 600; }

    .testimonials { display: flex; gap: 20px; flex-wrap: wrap; }
    .testimonial {
      flex: 1 1 calc(50% - 20px);
      background: #fafafa; border-radius: 12px; padding: 20px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }
    .testimonial img, .testimonial iframe {
      width: 100%; border-radius: 8px; margin-bottom: 15px;
    }
    .testimonial p { font-size: 0.95em; color: #555; }

    .secrets { background: #042b54; color: #fff; text-align: center; padding: 60px 20px; }
    .secrets h2 { 
      color: #fff; 
      border: none; 
      font-size: 1.8em; 
      margin-bottom: 30px; 
    }
    .secret-cards { 
      display: flex; 
      justify-content: center; 
      flex-wrap: wrap; 
      gap: 20px; 
    }
    .secret-card { 
      background: #fff; 
      color: #222; 
      border-radius: 10px; 
      width: 280px; 
      box-shadow: 0 5px 15px rgba(0,0,0,0.1); 
      overflow: hidden;
    }
    .secret-header { 
      background: #00b5ad; 
      color: #fff; 
      padding: 12px; 
      font-weight: 600; 
      text-transform: lowercase;
      font-size: 1.1em;
    }
    .secret-body { 
      padding: 20px; 
      border-top: 4px solid #ffd700;
      font-size: 0.95em;
    }

    .videos { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 20px; }
    .videos iframe { flex: 1 1 calc(50% - 20px); border-radius: 12px; height: 250px; }

    .offer { background: #f8f4ff; padding: 25px; border-radius: 12px; text-align: center; }
    .offer h3 { color: #5b4bff; margin-bottom: 15px; }
    .offer p { font-size: 1.05em; margin-bottom: 10px; }
    
    .event-links { margin-top: 20px; }
    .event-links p { margin: 10px 0; }
    .event-links a { color: #5b4bff; text-decoration: none; font-weight: 600; }
    .event-links a:hover { text-decoration: underline; }

    @media (max-width: 768px) {
      .testimonials { flex-direction: column; }
      .testimonial { flex: 1 1 100%; }
      .videos { flex-direction: column; }
      .videos iframe { flex: 1 1 100%; }
      .secret-cards { flex-direction: column; align-items: center; }
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <header>
      <h1>{{productName}}</h1>
      <p>{{adReference}}</p>
    </header>

    <div class="product-visual" id="product-visual">
      <img src="{{bannerAdUrl}}" alt="Product Banner" style="display: none;" id="banner-image">
    </div>

    <section id="product-details">
      <h2>Product Details</h2>
      <p class="product-desc">{{productDescription}}</p>
      <p class="price">{{price}}</p>
      <a href="{{signupLink}}" class="cta" target="_blank">Sign Up Now</a>
    </section>

    <section id="testimonials">
      <h2>Customer Success Stories</h2>
      <div class="testimonials">
        <div class="testimonial">
          <div id="testimonial-1-media"></div>
          <p>{{testimonial1Description}}</p>
        </div>
        <div class="testimonial">
          <div id="testimonial-2-media"></div>
          <p>{{testimonial2Description}}</p>
        </div>
      </div>
    </section>

    <section class="secrets">
      <h2>You'll Find Out...</h2>
      <div class="secret-cards">
        <div class="secret-card">
          <div class="secret-header">{{secret1Header}}</div>
          <div class="secret-body">{{secret1Body}}</div>
        </div>
        <div class="secret-card">
          <div class="secret-header">{{secret2Header}}</div>
          <div class="secret-body">{{secret2Body}}</div>
        </div>
        <div class="secret-card">
          <div class="secret-header">{{secret3Header}}</div>
          <div class="secret-body">{{secret3Body}}</div>
        </div>
      </div>
    </section>

    <section id="tutorials">
      <h2>Tutorials & Events</h2>
      <div class="videos">
        <iframe id="video-1" src="" frameborder="0" allowfullscreen></iframe>
        <iframe id="video-2" src="" frameborder="0" allowfullscreen></iframe>
      </div>
      <div class="event-links">
        <p><a href="{{scheduleCall}}" target="_blank" id="schedule-link">ðŸ“… Schedule a Call</a></p>
        <p><a href="{{livestreamEvent}}" target="_blank" id="livestream-link">ðŸŽ¥ Join Live Stream Event</a></p>
        <p><a href="{{signupLink}}" target="_blank" class="cta">Sign Up </a></p>
      </div>
    </section>

    <section id="final-offer">
      <h2>Final Offer</h2>
      <div class="offer">
        <h3>Limited-Time Bonus Bundle</h3>
        <p>{{bonusConfirmation}}</p>
      </div>
    </section>
  </div>

  <script data-template-script>
    window.addEventListener('DOMContentLoaded', function() {
      function extractVideoId(url) {
        if (!url) return null;
        const youtubeRegex = /(?:youtube\.com\/watch\?v=|youtu\.be\/)([^&\s]+)/;
        const match = url.match(youtubeRegex);
        return match ? match[1] : null;
      }

      function isImageUrl(url) {
        if (!url) return false;
        return /\.(jpg|jpeg|png|gif|webp|svg)(\?.*)?$/i.test(url);
      }

      function renderMedia(containerId, url) {
        const container = document.getElementById(containerId);
        if (!container || !url) return;

        const videoId = extractVideoId(url);
        if (videoId) {
          container.innerHTML = `<iframe src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen style="width: 100%; height: 250px; border-radius: 8px;"></iframe>`;
        } else if (isImageUrl(url)) {
          container.innerHTML = `<img src="${url}" alt="Media" style="width: 100%; border-radius: 8px;">`;
        } else if (url && url !== '') {
          container.innerHTML = `<div style="padding: 20px; background: #f0f0f0; border-radius: 8px; text-align: center; color: #666;">Media: ${url}</div>`;
        }
      }

      const bannerAdUrl = "{{bannerAdUrl}}";
      const video1Url = "{{video1}}";
      const video2Url = "{{video2}}";
      const testimonial1MediaUrl = "{{testimonial1Media}}";
      const testimonial2MediaUrl = "{{testimonial2Media}}";

      const bannerImage = document.getElementById('banner-image');
      if (bannerImage && bannerAdUrl && !bannerAdUrl.includes('{{')) {
        const videoId = extractVideoId(bannerAdUrl);
        if (videoId) {
          const productVisual = document.getElementById('product-visual');
          productVisual.innerHTML = `<iframe src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen></iframe>`;
        } else if (isImageUrl(bannerAdUrl)) {
          bannerImage.style.display = 'block';
        } else {
          bannerImage.style.display = 'block';
        }
      } else if (bannerImage) {
        document.getElementById('product-visual').style.display = 'none';
      }

      const video1Id = extractVideoId(video1Url);
      const video2Id = extractVideoId(video2Url);

      const video1Elem = document.getElementById('video-1');
      const video2Elem = document.getElementById('video-2');

      if (video1Id && video1Elem) {
        video1Elem.src = `https://www.youtube.com/embed/${video1Id}`;
      } else if (video1Elem) {
        video1Elem.style.display = 'none';
      }

      if (video2Id && video2Elem) {
        video2Elem.src = `https://www.youtube.com/embed/${video2Id}`;
      } else if (video2Elem) {
        video2Elem.style.display = 'none';
      }

      renderMedia('testimonial-1-media', testimonial1MediaUrl);
      renderMedia('testimonial-2-media', testimonial2MediaUrl);

      const scheduleLink = document.getElementById('schedule-link');
      if (scheduleLink && (!scheduleLink.href || scheduleLink.href === window.location.href || scheduleLink.href.includes('{{'))) {
        scheduleLink.parentElement.style.display = 'none';
      }

      const livestreamLink = document.getElementById('livestream-link');
      if (livestreamLink && (!livestreamLink.href || livestreamLink.href === window.location.href || livestreamLink.href.includes('{{'))) {
        livestreamLink.parentElement.style.display = 'none';
      }

      const allCtas = document.querySelectorAll('a.cta');
      allCtas.forEach(cta => {
        if (cta.href.includes('{{') || !cta.href || cta.href === window.location.href) {
          cta.style.display = 'none';
        }
      });
    });
  </script>
</body>
</html>
