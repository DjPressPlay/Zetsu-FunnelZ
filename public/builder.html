<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Funnel Builder</title>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: #000000;
      color: #2d3748;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: radial-gradient(circle at center, #1a1a1a, #000);
      padding: 20px;
      text-align: center;
      font-size: 28px;
      font-weight: bold;
      color: #fff;
      box-shadow: 0 2px 12px rgba(0, 255, 225, 0.15);
      border-bottom: 2px solid #00ffe1;
    }

    nav {
      background: #ffffff;
      display: flex;
      justify-content: flex-end;
      gap: 30px;
      padding: 15px 30px;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
      border-bottom: 1px solid #e2e8f0;
    }

    nav a {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
      font-size: 16px;
      transition: color 0.2s;
    }

    nav a:hover {
      color: #764ba2;
    }

    main {
      flex: 1;
      padding: 20px;
    }

    .builder-container {
      background: #ffffff;
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 24px;
      max-width: 900px;
      width: 100%;
      margin: 0 auto;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    h2 {
      color: #2d3748;
      margin-bottom: 20px;
      text-align: center;
      font-size: 20px;
      font-weight: 600;
    }

    .form-section {
      margin-bottom: 20px;
      padding: 16px;
      background: #f7fafc;
      border-radius: 6px;
      border: 1px solid #e2e8f0;
    }

    .form-section h3 {
      color: #4a5568;
      margin-top: 0;
      margin-bottom: 12px;
      font-size: 15px;
      font-weight: 600;
    }

    .compact-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
      margin-bottom: 20px;
    }

    .compact-field {
      display: flex;
      flex-direction: column;
    }

    .compact-field label {
      margin-bottom: 6px;
    }

    .compact-field input,
    .compact-field textarea {
      margin-bottom: 0;
    }

    label {
      display: block;
      margin-bottom: 5px;
      color: #4a5568;
      font-weight: 600;
      font-size: 13px;
    }

    label span {
      color: #718096;
      font-weight: normal;
      font-size: 12px;
    }

    input[type="text"],
    input[type="url"],
    input[type="number"],
    textarea,
    select {
      width: 100%;
      padding: 8px 10px;
      font-size: 13px;
      border: 1px solid #cbd5e0;
      border-radius: 4px;
      background: #ffffff;
      color: #2d3748;
      margin-bottom: 12px;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    textarea {
      min-height: 70px;
      resize: vertical;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
    }

    .video-container-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .video-input {
      display: flex;
      flex-direction: column;
    }

    .testimonial-item {
      margin-bottom: 0;
      padding: 12px;
      background: #ffffff;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
    }

    .testimonial-item:last-child {
      margin-bottom: 0;
    }

    .testimonial-item label {
      font-size: 13px;
    }

    .testimonial-item textarea {
      min-height: 60px;
    }

    .template-selection {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .template-option {
      padding: 20px;
      border: 2px solid #cbd5e0;
      border-radius: 8px;
      background: #ffffff;
      cursor: pointer;
      text-align: center;
      transition: all 0.2s ease;
    }

    .template-option:hover {
      background: #f7fafc;
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .template-option.selected {
      background: #edf2f7;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .button-group {
      display: flex;
      gap: 15px;
      margin-top: 30px;
    }

    button {
      flex: 1;
      padding: 10px 16px;
      font-size: 14px;
      font-weight: 600;
      border: 1px solid #667eea;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    #preview-btn {
      background: #ffffff;
      color: #667eea;
    }

    #preview-btn:hover {
      background: #f7fafc;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(102, 126, 234, 0.2);
    }

    #publish-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
      border-color: transparent;
    }

    #publish-btn:hover {
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .info-text {
      text-align: center;
      color: #718096;
      font-size: 14px;
      margin-top: 20px;
    }

    footer {
      text-align: center;
      padding: 1rem 1rem;
      font-size: .75rem;
      color: #777;
      border-top: 2px solid #fff;
      background: #0a0a0a;
    }

    footer p {
      margin: 0;
      line-height: 1;
      display: inline;
    }

    footer a {
      color: #00ffe1;
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    .instructions {
      background: #f7fafc;
      padding: 12px 16px;
      margin: 12px auto;
      max-width: 900px;
      border-radius: 6px;
      border-left: 2px solid #667eea;
    }

    .instructions h3 {
      margin-top: 0;
      color: #2d3748;
      font-size: 15px;
      margin-bottom: 8px;
      font-weight: 600;
    }

    .instructions ol {
      margin: 0;
      padding-left: 18px;
      color: #4a5568;
      line-height: 1.5;
      font-size: 13px;
    }

    .instructions li {
      margin-bottom: 4px;
    }

    .button-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 30px;
      background: transparent;
      border-bottom: none;
      box-shadow: none;
    }

    .floating-button {
      width: auto;
      min-width: 140px;
      height: auto;
      font-size: 14px;
      font-weight: 600;
      border: 2px solid #667eea;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
      background: #ffffff;
      color: #667eea;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: 12px 24px;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
    }

    .floating-button:hover {
      background: #667eea;
      color: #ffffff;
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(102, 126, 234, 0.5);
    }

    #template-style-btn {
      margin-right: auto;
    }

    #preview-viewer-btn {
      margin-left: auto;
    }

    .side-panel {
      position: fixed;
      left: -200px;
      top: 0;
      width: 200px;
      height: 100vh;
      background: #ffffff;
      border-right: 1px solid #e2e8f0;
      padding: 20px 0;
      z-index: 1000;
      overflow-y: auto;
      transition: left 0.3s ease;
      box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
    }

    .side-panel.open {
      left: 0;
    }

    .side-panel-item {
      padding: 10px 16px;
      color: #4a5568;
      font-weight: 600;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease;
      border-left: 2px solid transparent;
    }

    .side-panel-item:hover {
      background: #f7fafc;
      color: #667eea;
      border-left-color: #667eea;
    }

    .side-panel-item.active {
      background: #edf2f7;
      color: #667eea;
      border-left-color: #667eea;
    }

    .side-panel-tab {
      position: fixed;
      left: 0;
      top: 50%;
      transform: translateY(-50%);
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
      padding: 12px 6px;
      border-radius: 0 6px 6px 0;
      cursor: pointer;
      z-index: 1001;
      font-weight: 600;
      font-size: 12px;
      writing-mode: vertical-rl;
      text-orientation: mixed;
      box-shadow: 2px 2px 6px rgba(0, 0, 0, 0.15);
      transition: all 0.3s ease;
    }

    .side-panel-tab:hover {
      background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
      box-shadow: 2px 2px 12px rgba(102, 126, 234, 0.4);
      transform: translateY(-50%) translateX(2px);
    }

    .side-panel.open + .side-panel-tab {
      left: 200px;
      z-index: 1001;
    }

    .content-wrapper {
      margin-left: 0;
      transition: none;
    }

    .content-wrapper.panel-open {
      margin-left: 0;
    }

    .floating-container {
      display: none;
      position: fixed;
      width: 400px;
      height: 400px;
      background: #ffffff;
      border: 2px solid #667eea;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
      z-index: 1000;
      flex-direction: column;
      overflow: hidden;
    }

    .floating-container.active {
      display: flex;
    }

    #template-container {
      top: 120px;
      left: 30px;
    }

    #preview-container {
      top: 120px;
      right: 30px;
    }

    .floating-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: #ffffff;
    }

    .floating-header h3 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
    }

    .floating-close {
      background: rgba(255, 255, 255, 0.2);
      color: #ffffff;
      border: none;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: bold;
      font-size: 18px;
      line-height: 1;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .floating-close:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(90deg);
    }

    .floating-body {
      flex: 1;
      overflow: auto;
      padding: 20px;
    }

    .template-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    .template-card {
      padding: 20px;
      border: 2px solid #cbd5e0;
      border-radius: 8px;
      background: #f7fafc;
      cursor: pointer;
      text-align: center;
      transition: all 0.2s ease;
      font-weight: 600;
      color: #4a5568;
    }

    .template-card:hover {
      background: #edf2f7;
      border-color: #667eea;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(102, 126, 234, 0.2);
    }

    .template-card.selected {
      background: #667eea;
      border-color: #667eea;
      color: #ffffff;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
    }

    .preview-viewer-content {
      text-align: center;
    }

    .preview-viewer-content iframe {
      width: 100%;
      height: 280px;
      border: 1px solid #e2e8f0;
      border-radius: 6px;
      background: #ffffff;
    }

    .preview-actions {
      margin-top: 15px;
      display: flex;
      gap: 10px;
    }

    .preview-actions button {
      flex: 1;
      padding: 10px;
      background: #667eea;
      color: #ffffff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
    }

    .preview-actions button:hover {
      background: #764ba2;
      transform: translateY(-2px);
    }

    .preview-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }

    .preview-overlay.active {
      display: flex;
    }

    .preview-container {
      background: #ffffff;
      width: 90%;
      max-width: 1200px;
      height: 90%;
      border-radius: 12px;
      display: flex;
      flex-direction: column;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 2px solid #e2e8f0;
      background: #f7fafc;
      border-radius: 12px 12px 0 0;
    }

    .preview-header h3 {
      margin: 0;
      color: #2d3748;
      font-size: 18px;
    }

    .preview-close {
      background: #ef4444;
      color: #ffffff;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.2s ease;
    }

    .preview-close:hover {
      background: #dc2626;
      transform: scale(1.05);
    }

    .preview-content {
      flex: 1;
      overflow: auto;
      padding: 20px;
    }

    .preview-iframe {
      width: 100%;
      height: 100%;
      border: none;
      background: #ffffff;
    }

    #save-btn {
      background: #10b981;
      color: #ffffff;
      border-color: #10b981;
    }

    #save-btn:hover {
      background: #059669;
      border-color: #059669;
    }

    @media (max-width: 768px) {
      .side-panel {
        width: 60px;
        left: -60px;
      }

      .side-panel.open {
        left: 0;
      }

      .side-panel.open + .side-panel-tab {
        left: 60px;
      }

      .side-panel-item {
        font-size: 10px;
        padding: 12px 8px;
        text-align: center;
      }

      .side-panel-tab {
        font-size: 12px;
        padding: 12px 6px;
      }

      .content-wrapper {
        margin-left: 0;
      }

      .content-wrapper.panel-open {
        margin-left: 0;
      }

      .button-bar {
        padding: 10px 20px;
      }

      .floating-button {
        min-width: 100px;
        font-size: 12px;
        padding: 8px 12px;
      }

      #template-style-btn {
        margin-right: 0;
      }

      #preview-viewer-btn {
        margin-left: 0;
      }
      .video-container-group {
        grid-template-columns: 1fr;
      }

      .template-selection {
        grid-template-columns: 1fr 1fr;
      }

      .button-group {
        flex-direction: column;
      }

      .compact-row {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

  <header>
    Funnel Builder
  </header>

  <nav>
    <a href="index.html">Home</a>
    <a href="info.html">Info</a>
    <a href="builder.html">Builder</a>
    <a href="preview.html">Preview</a>
    <a href="affiliate.html">Affiliate</a>
  </nav>

  <div class="button-bar">
    <button id="template-style-btn" class="floating-button">Template Style</button>
    <button id="preview-viewer-btn" class="floating-button">Preview Viewer</button>
  </div>

  <div class="instructions">
    <h3>How to Create Your Funnel:</h3>
    <ol>
      <li>Fill in your product details and links in the form below</li>
      <li>Use the Template Style button to choose your funnel design</li>
      <li>Click Save to store your work as a draft</li>
      <li>Preview your funnel to see how it looks before publishing</li>
      <li>When ready, hit Publish to make your funnel live!</li>
    </ol>
  </div>

  <div class="side-panel" id="side-panel">
    <div class="side-panel-item active" data-section="drafts">Drafts</div>
    <div class="side-panel-item" data-section="previews">Previews</div>
    <div class="side-panel-item" data-section="published">Published</div>
    <div class="side-panel-item" data-section="quick-funnelz">Quick Funnelz</div>
    <div class="side-panel-item" data-section="files">Files</div>
  </div>

  <div class="side-panel-tab" id="side-panel-tab">MENU</div>

  <div class="floating-container" id="template-container">
    <div class="floating-header">
      <h3>Template Style Version</h3>
      <button class="floating-close" id="template-close">×</button>
    </div>
    <div class="floating-body">
      <div class="template-grid">
        <div class="template-card selected" data-template="classic">Classic</div>
        <div class="template-card" data-template="modern">Modern</div>
        <div class="template-card" data-template="minimal">Minimal</div>
        <div class="template-card" data-template="vibrant">Vibrant</div>
      </div>
    </div>
  </div>

  <div class="floating-container" id="preview-container">
    <div class="floating-header">
      <h3>Preview Viewer</h3>
      <button class="floating-close" id="preview-viewer-close">×</button>
    </div>
    <div class="floating-body">
      <div class="preview-viewer-content">
        <iframe id="mini-preview-iframe" src="preview.html"></iframe>
        <div class="preview-actions">
          <button id="refresh-preview-btn">Refresh</button>
          <button id="full-preview-btn">Full View</button>
        </div>
      </div>
    </div>
  </div>

  <div class="preview-overlay" id="preview-overlay">
    <div class="preview-container">
      <div class="preview-header">
        <h3>Live Preview</h3>
        <button class="preview-close" id="preview-close">Close</button>
      </div>
      <div class="preview-content">
        <iframe class="preview-iframe" id="preview-iframe" src="preview.html"></iframe>
      </div>
    </div>
  </div>

  <main class="content-wrapper" id="content-wrapper">
    <div class="builder-container">
      <h2>Create Your Funnel</h2>
      
      <form id="funnel-form">
        
        <div class="form-section">
          <div class="compact-row">
            <div class="compact-field">
              <label for="product-name">Product Name</label>
              <input 
                type="text" 
                id="product-name" 
                name="productName"
                placeholder="Enter your product name" 
                maxlength="100"
                required
              />
            </div>
            <div class="compact-field">
              <label for="ad-reference">Ad Reference <span>(Optional)</span></label>
              <input 
                type="text" 
                id="ad-reference" 
                name="adReference"
                placeholder="Reference to your ad campaign" 
                maxlength="100"
              />
            </div>
          </div>

          <label for="product-description">Product Description</label>
          <textarea 
            id="product-description" 
            name="productDescription"
            placeholder="Example: Transform your business with our comprehensive automation suite. Save 10+ hours weekly with smart workflows, advanced analytics, and seamless integrations. Perfect for entrepreneurs looking to scale efficiently."
            maxlength="1000"
            required
          ></textarea>
        </div>

        <div class="form-section">
          <div class="compact-row">
            <div class="compact-field">
              <label for="signup-link">Sign-up Link</label>
              <input 
                type="url" 
                id="signup-link" 
                name="signupLink"
                placeholder="https://example.com/signup" 
                required
              />
            </div>
            <div class="compact-field">
              <label for="price">Price</label>
              <input 
                type="text" 
                id="price" 
                name="price"
                placeholder="$99 or Free" 
                maxlength="50"
                required
              />
            </div>
          </div>
        </div>

        <div class="form-section">
          <label>Testimonials</label>
          <div id="testimonials-container">
            <div class="compact-row">
              <div class="testimonial-item" data-index="0">
                <label for="testimonial-media-0">Testimonial 1 - Image/Video URL</label>
                <input 
                  type="url" 
                  id="testimonial-media-0"
                  name="testimonial1Media"
                  placeholder="https://example.com/image.jpg or https://youtube.com/watch?v=..." 
                  required
                />
                <label for="testimonial-desc-0">Testimonial 1 - Description</label>
                <textarea 
                  id="testimonial-desc-0"
                  name="testimonial1Description"
                  placeholder="Example: 'This product completely changed my workflow! I went from spending hours on manual tasks to having everything automated. My revenue increased by 300% in just 3 months!' - Sarah J., Entrepreneur"
                  maxlength="500"
                  required
                ></textarea>
              </div>
              <div class="testimonial-item" data-index="1">
                <label for="testimonial-media-1">Testimonial 2 - Image/Video URL</label>
                <input 
                  type="url" 
                  id="testimonial-media-1"
                  name="testimonial2Media"
                  placeholder="https://example.com/image.jpg or https://youtube.com/watch?v=..." 
                  required
                />
                <label for="testimonial-desc-1">Testimonial 2 - Description</label>
                <textarea 
                  id="testimonial-desc-1"
                  name="testimonial2Description"
                  placeholder="Example: 'Best investment I ever made for my business. The support team is incredible, and the ROI was immediate. I recommend this to everyone in my network!' - Mike T., Marketing Director"
                  maxlength="500"
                  required
                ></textarea>
              </div>
            </div>
          </div>
        </div>

        <div class="form-section">
          <label>Two Tutorial Video Containers</label>
          <div class="compact-row">
            <div class="compact-field">
              <label for="video-1">Tutorial Video 1 URL</label>
              <input 
                type="url" 
                id="video-1" 
                name="video1"
                placeholder="https://youtube.com/watch?v=..." 
                required
              />
            </div>
            <div class="compact-field">
              <label for="video-2">Tutorial Video 2 URL</label>
              <input 
                type="url" 
                id="video-2" 
                name="video2"
                placeholder="https://youtube.com/watch?v=..." 
                required
              />
            </div>
          </div>
        </div>

        <div class="form-section">
          <div class="compact-row">
            <div class="compact-field">
              <label for="schedule-call">Schedule a Call / Join TG <span>(Optional)</span></label>
              <input 
                type="url" 
                id="schedule-call" 
                name="scheduleCall"
                placeholder="https://example.com/schedule" 
              />
            </div>
            <div class="compact-field">
              <label for="livestream-event">Join Live Stream Event (Book Spot)</label>
              <input 
                type="url" 
                id="livestream-event" 
                name="livestreamEvent"
                placeholder="https://example.com/livestream" 
                required
              />
            </div>
          </div>
        </div>

        <div class="form-section">
          <label for="signup-link-repeat">Sign-up (repeat CTA)</label>
          <input 
            type="url" 
            id="signup-link-repeat" 
            name="signupLinkRepeat"
            placeholder="https://example.com/signup" 
            required
          />

          <label for="bonus-confirmation">Price / Bonus Confirmation</label>
          <textarea 
            id="bonus-confirmation" 
            name="bonusConfirmation"
            placeholder="Example: Get started today for only $97! Plus receive 3 exclusive bonuses: Premium Templates Pack ($297 value), 1-on-1 Strategy Session ($500 value), and Lifetime Updates (Priceless). Total value: $894 - Yours for just $97!"
            maxlength="500"
            required
          ></textarea>
        </div>

        <input type="hidden" id="template" name="template" value="classic" />

        <div class="button-group">
          <button type="button" id="save-btn">Save Draft</button>
          <button type="button" id="preview-btn">Preview Button: shows exactly how the funnel will appear</button>
          <button type="submit" id="publish-btn">Publish Button: generates a live site ready for promotion</button>
        </div>

        <p class="info-text">Fill out all required fields to preview and publish your funnel</p>
      </form>
    </div>
  </main>

  <footer>
    <p>© 2025 Zetsumetsu Corporation™ | All systems, products, and materials are the property of Zetsumetsu Corporation. Unauthorized use or reproduction is prohibited. | Zetsumetsu EOe™ | Artworqq Kevin Suber |
         <br> <a href="https://sporez.netlify.app/" target="_blank">Spore'z Network</a> | <a href="#">SignalZ</a> | <a href="#">Z-Auth</a></p>
  </footer>

  <script>
    const form = document.getElementById('funnel-form');
    const previewBtn = document.getElementById('preview-btn');
    const publishBtn = document.getElementById('publish-btn');
    const saveBtn = document.getElementById('save-btn');
    const templateInput = document.getElementById('template');
    const templateStyleBtn = document.getElementById('template-style-btn');
    const previewViewerBtn = document.getElementById('preview-viewer-btn');
    const previewOverlay = document.getElementById('preview-overlay');
    const previewClose = document.getElementById('preview-close');
    const previewIframe = document.getElementById('preview-iframe');
    const sidePanelItems = document.querySelectorAll('.side-panel-item');
    const sidePanel = document.getElementById('side-panel');
    const sidePanelTab = document.getElementById('side-panel-tab');
    const contentWrapper = document.getElementById('content-wrapper');
    
    const templateContainer = document.getElementById('template-container');
    const previewContainer = document.getElementById('preview-container');
    const templateClose = document.getElementById('template-close');
    const previewViewerClose = document.getElementById('preview-viewer-close');
    const templateCards = document.querySelectorAll('.template-card');
    const miniPreviewIframe = document.getElementById('mini-preview-iframe');
    const refreshPreviewBtn = document.getElementById('refresh-preview-btn');
    const fullPreviewBtn = document.getElementById('full-preview-btn');

    const templates = ['classic', 'modern', 'minimal', 'vibrant'];
    let currentTemplateIndex = 0;
    let isPanelOpen = false;

    sidePanelTab.addEventListener('click', () => {
      isPanelOpen = !isPanelOpen;
      if (isPanelOpen) {
        sidePanel.classList.add('open');
        sidePanelTab.textContent = 'CLOSE';
      } else {
        sidePanel.classList.remove('open');
        sidePanelTab.textContent = 'MENU';
      }
    });

    templateStyleBtn.addEventListener('click', () => {
      templateContainer.classList.add('active');
    });

    templateClose.addEventListener('click', () => {
      templateContainer.classList.remove('active');
    });

    previewViewerBtn.addEventListener('click', () => {
      saveFunnelData();
      miniPreviewIframe.src = 'preview.html?' + new Date().getTime();
      previewContainer.classList.add('active');
    });

    previewViewerClose.addEventListener('click', () => {
      previewContainer.classList.remove('active');
    });

    refreshPreviewBtn.addEventListener('click', () => {
      saveFunnelData();
      miniPreviewIframe.src = 'preview.html?' + new Date().getTime();
    });

    fullPreviewBtn.addEventListener('click', () => {
      saveFunnelData();
      previewIframe.src = 'preview.html?' + new Date().getTime();
      previewOverlay.classList.add('active');
    });

    templateCards.forEach(card => {
      card.addEventListener('click', () => {
        templateCards.forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        
        const selectedTemplate = card.dataset.template;
        templateInput.value = selectedTemplate;
        currentTemplateIndex = templates.indexOf(selectedTemplate);
        
        saveFunnelData();
      });
    });

    sidePanelItems.forEach(item => {
      item.addEventListener('click', () => {
        sidePanelItems.forEach(i => i.classList.remove('active'));
        item.classList.add('active');
        
        const section = item.dataset.section;
        console.log(`Navigating to ${section} section`);
      });
    });

    previewClose.addEventListener('click', () => {
      previewOverlay.classList.remove('active');
    });

    previewOverlay.addEventListener('click', (e) => {
      if (e.target === previewOverlay) {
        previewOverlay.classList.remove('active');
      }
    });

    function loadFunnelData() {
      const savedData = localStorage.getItem('funnelData');
      if (savedData) {
        try {
          const data = JSON.parse(savedData);
          Object.keys(data).forEach(key => {
            const input = form.querySelector(`[name="${key}"]`);
            if (input) {
              input.value = data[key];
            }
          });
          
          if (data.template) {
            const templateIndex = templates.indexOf(data.template);
            if (templateIndex !== -1) {
              currentTemplateIndex = templateIndex;
              templateCards.forEach(card => {
                if (card.dataset.template === data.template) {
                  card.classList.add('selected');
                } else {
                  card.classList.remove('selected');
                }
              });
            }
          }
        } catch (e) {
          console.error('Error loading saved data:', e);
        }
      }
    }

    function saveFunnelData() {
      const formData = new FormData(form);
      const data = {};
      formData.forEach((value, key) => {
        data[key] = value;
      });
      localStorage.setItem('funnelData', JSON.stringify(data));
    }

    loadFunnelData();

    form.addEventListener('input', () => {
      saveFunnelData();
    });

    saveBtn.addEventListener('click', () => {
      saveFunnelData();
      localStorage.setItem('funnelDraftSaved', 'true');
      localStorage.setItem('funnelDraftDate', new Date().toISOString());
      alert('Draft saved successfully! Your work has been stored.');
    });

    previewBtn.addEventListener('click', () => {
      saveFunnelData();
      window.location.href = 'preview.html';
    });

    form.addEventListener('submit', (e) => {
      e.preventDefault();
      
      const formData = new FormData(form);
      const data = {};
      formData.forEach((value, key) => {
        data[key] = value;
      });

      localStorage.setItem('funnelData', JSON.stringify(data));
      localStorage.setItem('funnelPublished', 'true');
      localStorage.setItem('funnelPublishDate', new Date().toISOString());
      
      alert(`Funnel "${data.productName}" published successfully! Your funnel is now live and ready for promotion.`);
      
      window.location.href = 'preview.html';
    });
  </script>

</body>
</html>
